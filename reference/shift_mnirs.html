<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Shift data range — shift_mnirs • mnirs</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Shift data range — shift_mnirs"><meta name="description" content="Move the range of data channels in a data frame up or down, while preserving
the absolute amplitude/dynamic range of each channel, and the relative
scaling across channels. e.g. shift the minimum data value to zero for all
positive values, or shift the mean of the first time span in a recording
to zero."><meta property="og:description" content="Move the range of data channels in a data frame up or down, while preserving
the absolute amplitude/dynamic range of each channel, and the relative
scaling across channels. e.g. shift the minimum data value to zero for all
positive values, or shift the mean of the first time span in a recording
to zero."><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@jem_arnold"><meta name="twitter:site" content="@jem_arnold"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mnirs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/reading-mnirs-data.html">Reading and Cleaning Data with {mnirs}</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/jemarnold.bsky.social" aria-label="Bluesky"><span class="fa fa-brands fa-bluesky"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/jem_arnold" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jemarnold/epl" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Shift data range</h1>
      <small class="dont-index">Source: <a href="https://github.com/jemarnold/mnirs/blob/main/R/shift_mnirs.R" class="external-link"><code>R/shift_mnirs.R</code></a></small>
      <div class="d-none name"><code>shift_mnirs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Move the range of data channels in a data frame up or down, while preserving
the absolute amplitude/dynamic range of each channel, and the relative
scaling across channels. e.g. shift the minimum data value to zero for all
positive values, or shift the mean of the first time span in a recording
to zero.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">shift_mnirs</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  nirs_channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  time_channel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  to <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  width <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  span <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"first"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame of class <em>"mnirs"</em> containing at least one
column with numeric time or sample values, and one column with numeric
mNIRS values, along with metadata.</p></dd>


<dt id="arg-nirs-channels">nirs_channels<a class="anchor" aria-label="anchor" href="#arg-nirs-channels"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> of character vectors indicating the column
names for data channels to be shifted (see <em>Details</em>).</p><dl><dt><code>list("A", "B", "C")</code></dt>
<dd><p>Will shift each channel independently,
losing the relative scaling between channels.</p></dd>

<dt><code>list(c("A", "B", "C"))</code></dt>
<dd><p>Will shift all channels together,
preserving the relative scaling between channels.</p></dd>

<dt><code>list(c("A", "B"), c("C", "D"))</code></dt>
<dd><p>Will shift channels <code>A</code> and <code>B</code>
in one group, and channels <code>C</code> and <code>D</code> in another group, preserving
relative scaling within, but not between groups.</p></dd>


</dl><p>Must match column names in data exactly. Will be taken from metadata if
not defined explicitly.</p></dd>


<dt id="arg-time-channel">time_channel<a class="anchor" aria-label="anchor" href="#arg-time-channel"></a></dt>
<dd><p>A character string indicating the time or sample channel
name. Must match column names in <code>data</code> exactly. Will be taken from
metadata if not defined explicitly.</p></dd>


<dt id="arg-to">to<a class="anchor" aria-label="anchor" href="#arg-to"></a></dt>
<dd><p>A numeric value in units of <code>nirs_channels</code> to which the data
channels will be shifted, e.g. shift the minimum value to zero.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>A numeric value in units of <code>nirs_channels</code> by which the data
channels will be shifted, e.g. shift all values up by 10 units.</p></dd>


<dt id="arg-width">width<a class="anchor" aria-label="anchor" href="#arg-width"></a></dt>
<dd><p>An integer defining the local window in number of samples
around <code>idx</code> in which to perform the operation., between
<code>[idx - floor(width/2), idx + floor(width/2)]</code>.</p></dd>


<dt id="arg-span">span<a class="anchor" aria-label="anchor" href="#arg-span"></a></dt>
<dd><p>A numeric value defining the local window timespan around <code>idx</code>
in which to perform the operation. In units of <code>time_channel</code> or <code>t</code>,
between <code>[t - span/2, t + span/2]</code>.</p></dd>


<dt id="arg-position">position<a class="anchor" aria-label="anchor" href="#arg-position"></a></dt>
<dd><p>Indicates where the reference values will be shifted from.</p><dl><dt><code>"min"</code></dt>
<dd><p>(The <em>default</em>) will shift the minimum value(s) <code>to</code>
or <code>by</code> the specified value.</p></dd>

<dt><code>"max"</code></dt>
<dd><p>Will shift the maximum value(s) <code>to</code> or <code>by</code> the
specified values.</p></dd>

<dt><code>"first"</code></dt>
<dd><p>Will shift first value(s) <code>to</code> or <code>by</code> the specified
values.</p></dd>


</dl></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical to return (the <em>default</em>) or silence warnings and
messages which can be used for data error checking. Abort errors will
always be returned.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <a href="https://tibble.tidyverse.org/reference/tibble-package.html" class="external-link">tibble</a> of class <em>"mnirs"</em> with metadata
available with <code><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>nirs_channels = list()</code> can be used to group data channels to preserve
absolute or relative scaling.</p><ul><li><p>Channels grouped together in a list item will be shifted to a common
value, and the relative scaling within that group will be preserved.</p></li>
<li><p>Channels grouped in separate list items will be shifted independently,
and relative scaling between groups will be lost.</p></li>
<li><p>Channels (columns) in <code>data</code> not explicitly defined in <code>nirs_channels</code>
will be passed through untouched to the output data frame.</p></li>
</ul><p><code>nirs_channels</code> and <code>time_channel</code> can be retrieved automatically from
<code>data</code> of class <em>"mnirs"</em> which has been processed with <code>{mnirs}</code>,
if not defined explicitly. This will default to returning all
<code>nirs_channels</code> grouped together, and should be defined explicitly
for other grouping arrangements.</p>
<p>Only one of either <code>to</code> or <code>by</code> and one of either <code>width</code> or <code>span</code> should
be defined. If both of either pairing are defined, <code>to</code> will be preferred
over <code>by</code>, and <code>width</code> will be preferred over <code>span</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## read example data</span></span></span>
<span class="r-in"><span><span class="va">data_shifted</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_mnirs.html">read_mnirs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    file_path <span class="op">=</span> <span class="fu"><a href="example_mnirs.html">example_mnirs</a></span><span class="op">(</span><span class="st">"moxy_ramp"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    nirs_channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>smo2 <span class="op">=</span> <span class="st">"SmO2 Live"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    time_channel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>time <span class="op">=</span> <span class="st">"hh:mm:ss"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="resample_mnirs.html">resample_mnirs</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="replace_mnirs.html">replace_mnirs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        invalid_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        outlier_cutoff <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>        width <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>        verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="filter_mnirs.html">filter_mnirs</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">shift_mnirs</span><span class="op">(</span></span></span>
<span class="r-in"><span>        to <span class="op">=</span> <span class="fl">0</span>,             <span class="co">## NIRS values will be shifted to zero</span></span></span>
<span class="r-in"><span>        span <span class="op">=</span> <span class="fl">120</span>,         <span class="co">## shift the first 120 sec of data to zero</span></span></span>
<span class="r-in"><span>        position <span class="op">=</span> <span class="st">"first"</span>,</span></span>
<span class="r-in"><span>        verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">data_shifted</span>, label_time <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="shift_mnirs-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jem Arnold.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

