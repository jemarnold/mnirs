<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Muscle Near-Infrared Spectroscopy Processing &amp; Analysis ‚Ä¢ mnirs</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Muscle Near-Infrared Spectroscopy Processing &amp; Analysis">
<meta name="description" content="Methods for reading, processing, and analysing data from muscle near-infrared spectroscopy (mNIRS) devices.">
<meta property="og:description" content="Methods for reading, processing, and analysing data from muscle near-infrared spectroscopy (mNIRS) devices.">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@jem_arnold">
<meta name="twitter:site" content="@jem_arnold">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">mnirs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/reading-mnirs-data.html">Reading and Cleaning Data with {mnirs}</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/jemarnold.bsky.social" aria-label="Bluesky"><span class="fa fa-brands fa-bluesky"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/jem_arnold" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jemarnold/epl" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="muscle-near-infrared-spectroscopy-mnirs">Muscle Near-Infrared Spectroscopy (mNIRS)<a class="anchor" aria-label="anchor" href="#muscle-near-infrared-spectroscopy-mnirs"></a>
</h1></div>
<!-- badges: start -->

<p><em>{mnirs}</em> is a package for reading, processing, and analysing data from muscle near-infrared spectroscopy (mNIRS) devices.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <em>{mnirs}</em> from <a href="https://github.com/jemarnold/mnirs" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"jemarnold/mnirs"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p><code>&lt;coming soon&gt;</code></p>
</div>
<div class="section level2">
<h2 id="online-app">Online App<a class="anchor" aria-label="anchor" href="#online-app"></a>
</h2>
<p>A very basic implementation of this package is hosted at <a href="https://jem-arnold.shinyapps.io/mnirs-app/" class="external-link uri">https://jem-arnold.shinyapps.io/mnirs-app/</a> and can be used for mNIRS data importing and cleaning.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>A more detailed vignette for common usage can be found here: <a href="https://jemarnold.github.io/mnirs.dev/articles/cleaning-mnirs-data.html">Reading and Cleaning Data with {mnirs}</a></p>
<p><em>{mnirs}</em> is currently in experimental development and functionality may change! Stay updated on development and follow releases at <a href="https://github.com/jemarnold/mnirs" class="external-link">github.com/jemarnold/mnirs</a>.</p>
<p><em>{mnirs}</em> is designed to process mNIRS data, but there is no reason why it can‚Äôt be used to read, clean, and filter other time series datasets, which require many of the same processing steps. Enjoy!</p>
<div class="section level3">
<h3 id="read_mnirs-read-data-from-file">
<code>read_mnirs()</code> Read data from file<a class="anchor" aria-label="anchor" href="#read_mnirs-read-data-from-file"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># remotes::install_github("jemarnold/mnirs") ## install development version</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co">## load for plotting</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jemarnold.github.io/mnirs/">mnirs</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## {mnirs} includes sample files from a few mNIRS devices</span></span>
<span><span class="fu"><a href="reference/example_mnirs.html">example_mnirs</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "artinis_intervals.xlsx"  "moxy_intervals.csv"     </span></span>
<span><span class="co">#&gt; [3] "moxy_ramp.xlsx"          "train.red_intervals.csv"</span></span>
<span></span>
<span><span class="co">## partial matching will error if matches multiple</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="reference/example_mnirs.html">example_mnirs</a></span><span class="op">(</span><span class="st">"moxy"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in example_mnirs("moxy") : ‚úñ Multiple files match "moxy":</span></span>
<span><span class="co">#&gt; ‚Ñπ Matching files: "moxy_intervals.csv" and "moxy_ramp.xlsx"</span></span>
<span></span>
<span><span class="co">## call an example mNIRS data file</span></span>
<span><span class="va">file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/example_mnirs.html">example_mnirs</a></span><span class="op">(</span><span class="st">"moxy_ramp"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">## rename channels in the format `new_name1 = "original_name1"`</span></span>
<span><span class="co">## where "original_name1" should match the file column name exactly</span></span>
<span><span class="va">data_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_mnirs.html">read_mnirs</a></span><span class="op">(</span></span>
<span>    <span class="va">file_path</span>,</span>
<span>    nirs_channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>smo2_right <span class="op">=</span> <span class="st">"SmO2 Live"</span>, <span class="co">## identify and rename channels</span></span>
<span>                      smo2_left <span class="op">=</span> <span class="st">"SmO2 Live(2)"</span><span class="op">)</span>,</span>
<span>    time_channel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>time <span class="op">=</span> <span class="st">"hh:mm:ss"</span><span class="op">)</span>, <span class="co">## date-time format will be converted to numeric</span></span>
<span>    event_channel <span class="op">=</span> <span class="cn">NULL</span>,                <span class="co">## left blank, not currently used in analysis</span></span>
<span>    sample_rate <span class="op">=</span> <span class="cn">NULL</span>,                  <span class="co">## sample_rate will be estimated from time column</span></span>
<span>    add_timestamp <span class="op">=</span> <span class="cn">FALSE</span>,               <span class="co">## omit the date-time timestamp column</span></span>
<span>    zero_time <span class="op">=</span> <span class="cn">TRUE</span>,                    <span class="co">## recalculate time values from zero</span></span>
<span>    keep_all <span class="op">=</span> <span class="cn">FALSE</span>,                    <span class="co">## return only the specified data channels</span></span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span>                       <span class="co">## show warnings &amp; messages</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ! Estimated `sample_rate` = 2 Hz.</span></span>
<span><span class="co">#&gt; ‚Ñπ Overwrite this with `sample_rate` = &lt;numeric&gt;.</span></span>
<span><span class="co">#&gt; Warning: ! `time_channel` has duplicated or irregular samples. Consider re-sampling with</span></span>
<span><span class="co">#&gt;   `mnirs::resample_mnirs()`.</span></span>
<span><span class="co">#&gt; ‚Ñπ Investigate at `time` = 211.99, 211.99, and 1184.</span></span>
<span></span>
<span><span class="co">## ignore the warning about repeated samples for now ‚òù</span></span>
<span><span class="co">## Note that sample_rate was estimated correctly at 2 Hz</span></span>
<span></span>
<span><span class="va">data_table</span></span>
<span><span class="co">#&gt; # A tibble: 2,203 √ó 3</span></span>
<span><span class="co">#&gt;     time smo2_right smo2_left</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1  0            54        68</span></span>
<span><span class="co">#&gt;  2  0.4          54        68</span></span>
<span><span class="co">#&gt;  3  0.96         54        68</span></span>
<span><span class="co">#&gt;  4  1.51         54        66</span></span>
<span><span class="co">#&gt;  5  2.06         54        66</span></span>
<span><span class="co">#&gt;  6  2.61         54        66</span></span>
<span><span class="co">#&gt;  7  3.16         54        66</span></span>
<span><span class="co">#&gt;  8  3.71         57        67</span></span>
<span><span class="co">#&gt;  9  4.26         57        67</span></span>
<span><span class="co">#&gt; 10  4.81         57        67</span></span>
<span><span class="co">#&gt; # ‚Ñπ 2,193 more rows</span></span>
<span></span>
<span><span class="co">## note the hidden plot option to display timestamp values as `hh:mm:ss`</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">data_table</span>, label_time <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="metadata-stored-in-mnirs-data-frames">Metadata stored in <code>mnirs</code> data frames<a class="anchor" aria-label="anchor" href="#metadata-stored-in-mnirs-data-frames"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## view metadata, omitting item two (a list of row numbers)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">data_table</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#&gt; $class</span></span>
<span><span class="co">#&gt; [1] "mnirs"      "tbl_df"     "tbl"        "data.frame"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $names</span></span>
<span><span class="co">#&gt; [1] "time"       "smo2_right" "smo2_left" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $nirs_channels</span></span>
<span><span class="co">#&gt; [1] "smo2_right" "smo2_left" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $time_channel</span></span>
<span><span class="co">#&gt; [1] "time"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sample_rate</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $verbose</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co">## define nirs_channels externally for later use</span></span>
<span><span class="va">nirs_channels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">data_table</span>, <span class="st">"nirs_channels"</span><span class="op">)</span></span>
<span><span class="va">nirs_channels</span></span>
<span><span class="co">#&gt; [1] "smo2_right" "smo2_left"</span></span>
<span></span>
<span><span class="co">## add nirs device to metadata</span></span>
<span><span class="va">data_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_mnirs_data.html">create_mnirs_data</a></span><span class="op">(</span><span class="va">data_table</span>, nirs_device <span class="op">=</span> <span class="st">"Moxy"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## check that the added metadata is now present</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">data_table</span>, <span class="st">"nirs_device"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Moxy"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="replace_mnirs-replace-local-outliers-invalid-values-and-missing-values">
<code>replace_mnirs</code>: Replace local outliers, invalid values, and missing values<a class="anchor" aria-label="anchor" href="#replace_mnirs-replace-local-outliers-invalid-values-and-missing-values"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_cleaned</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/replace_mnirs.html">replace_mnirs</a></span><span class="op">(</span></span>
<span>    <span class="va">data_table</span>,</span>
<span>    nirs_channels <span class="op">=</span> <span class="cn">NULL</span>,       <span class="co">## default to all nirs_channels in metadata</span></span>
<span>    time_channel <span class="op">=</span> <span class="cn">NULL</span>,        <span class="co">## default to time_channel in metadata</span></span>
<span>    invalid_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>, <span class="co">## known invalid values in the data</span></span>
<span>    outlier_cutoff <span class="op">=</span> <span class="fl">3</span>,         <span class="co">## recommended default value</span></span>
<span>    width <span class="op">=</span> <span class="fl">7</span>,                  <span class="co">## local window to detect local outliers and replace missing values</span></span>
<span>    method <span class="op">=</span> <span class="st">"linear"</span>           <span class="co">## linear interpolation over `NA`s</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">data_cleaned</span>, label_time <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="resample_mnirs-resample-data">
<code>resample_mnirs()</code>: Resample data<a class="anchor" aria-label="anchor" href="#resample_mnirs-resample-data"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_resampled</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/resample_mnirs.html">resample_mnirs</a></span><span class="op">(</span></span>
<span>    <span class="va">data_cleaned</span>,</span>
<span>    <span class="co"># time_channel = NULL,        ## taken from metadata</span></span>
<span>    <span class="co"># sample_rate = NULL,</span></span>
<span>    <span class="co"># resample_rate = sample_rate ## the default will re-sample to sample_rate</span></span>
<span>    method <span class="op">=</span> <span class="st">"linear"</span>,            <span class="co">## default linear interpolation across any new samples</span></span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span>                <span class="co">## will confirm the output sample rate</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ‚Ñπ Output is resampled at 2 Hz.</span></span>
<span></span>
<span><span class="co">## note the altered "time" values üëá</span></span>
<span><span class="va">data_resampled</span></span>
<span><span class="co">#&gt; # A tibble: 2,419 √ó 3</span></span>
<span><span class="co">#&gt;     time smo2_right smo2_left</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1   0         54        68  </span></span>
<span><span class="co">#&gt;  2   0.5       54        68  </span></span>
<span><span class="co">#&gt;  3   1         54        67.9</span></span>
<span><span class="co">#&gt;  4   1.5       54        66.0</span></span>
<span><span class="co">#&gt;  5   2         54        66  </span></span>
<span><span class="co">#&gt;  6   2.5       54        66  </span></span>
<span><span class="co">#&gt;  7   3         54        66  </span></span>
<span><span class="co">#&gt;  8   3.5       55.9      66.6</span></span>
<span><span class="co">#&gt;  9   4         57        67  </span></span>
<span><span class="co">#&gt; 10   4.5       57        67  </span></span>
<span><span class="co">#&gt; # ‚Ñπ 2,409 more rows</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="filter_mnirs-digital-filtering">
<code>filter_mnirs()</code>: Digital filtering<a class="anchor" aria-label="anchor" href="#filter_mnirs-digital-filtering"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_filtered</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/filter_mnirs.html">filter_mnirs</a></span><span class="op">(</span></span>
<span>    <span class="va">data_resampled</span>,</span>
<span>    <span class="co"># nirs_channel = NULL,  ## taken from metadata</span></span>
<span>    <span class="co"># time_channel = NULL,</span></span>
<span>    <span class="co"># sample_rate = NULLL,</span></span>
<span>    method <span class="op">=</span> <span class="st">"butterworth"</span>, <span class="co">## Butterworth digital filter is a common choice</span></span>
<span>    type <span class="op">=</span> <span class="st">"low"</span>,           <span class="co">## specify a low-pass filter</span></span>
<span>    n <span class="op">=</span> <span class="fl">2</span>,                  <span class="co">## filter order number</span></span>
<span>    W <span class="op">=</span> <span class="fl">0.02</span>                <span class="co">## filter fractional critical frequency</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## we will add the non-filtered data back to the plot to compare</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">data_filtered</span>, label_time <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">data_cleaned</span>, </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">smo2_left</span>, colour <span class="op">=</span> <span class="st">"smo2_left"</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.4</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">data_cleaned</span>, </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">smo2_right</span>, colour <span class="op">=</span> <span class="st">"smo2_right"</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.4</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="shift_mnirs--rescale_mnirs-shift-and-rescale-data">
<code>shift_mnirs()</code> &amp; <code>rescale_mnirs()</code>: Shift and rescale data<a class="anchor" aria-label="anchor" href="#shift_mnirs--rescale_mnirs-shift-and-rescale-data"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## our default *mnirs* nirs_channel will be grouped together</span></span>
<span><span class="va">nirs_channels</span></span>
<span><span class="co">#&gt; [1] "smo2_right" "smo2_left"</span></span>
<span></span>
<span><span class="co">## to shift each nirs_channel separately, the channels should be un-grouped</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">nirs_channels</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] "smo2_right"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] "smo2_left"</span></span>
<span></span>
<span><span class="va">data_shifted</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/shift_mnirs.html">shift_mnirs</a></span><span class="op">(</span></span>
<span>    <span class="va">data_filtered</span>,</span>
<span>    nirs_channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">nirs_channels</span><span class="op">)</span>, <span class="co">## un-grouped, as above</span></span>
<span>    to <span class="op">=</span> <span class="fl">0</span>,                                 <span class="co">## NIRS values will be shifted to zero</span></span>
<span>    span <span class="op">=</span> <span class="fl">120</span>,                             <span class="co">## shift the first 120 sec of data to zero</span></span>
<span>    position <span class="op">=</span> <span class="st">"first"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">data_shifted</span>, label_time <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="100%"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_rescaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rescale_mnirs.html">rescale_mnirs</a></span><span class="op">(</span></span>
<span>    <span class="va">data_filtered</span>,</span>
<span>    nirs_channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">nirs_channels</span><span class="op">)</span>, <span class="co">## un-group `nirs_channels` to rescale each channel separately</span></span>
<span>    range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>                       <span class="co">## rescale to a 0-100% functional exercise range</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">data_rescaled</span>, label_time <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="pipe-friendly-functions">Pipe-friendly functions<a class="anchor" aria-label="anchor" href="#pipe-friendly-functions"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## un-group `nirs_channels` to shift each channel separately</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">nirs_channels</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] "smo2_right"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] "smo2_left"</span></span>
<span></span>
<span><span class="co">## then group `nirs_channels` to rescale together </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">nirs_channels</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] "smo2_right" "smo2_left"</span></span>
<span></span>
<span><span class="co">## pipe (base R `|&gt;` or {magrittr} `%&gt;%`) from one function to the next</span></span>
<span><span class="va">data_rescaled</span> <span class="op">&lt;-</span> <span class="va">data_filtered</span> <span class="op">|&gt;</span> </span>
<span>    <span class="co">## shift the mean of the first 120 sec of each signal to zero</span></span>
<span>    <span class="fu"><a href="reference/shift_mnirs.html">shift_mnirs</a></span><span class="op">(</span></span>
<span>        nirs_channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">nirs_channels</span><span class="op">)</span>, <span class="co">## un-grouped</span></span>
<span>        to <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        position <span class="op">=</span> <span class="st">"first"</span>,</span>
<span>        span <span class="op">=</span> <span class="fl">120</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="co">## then rescale the min and max of the grouped data to 0-100%</span></span>
<span>    <span class="fu"><a href="reference/rescale_mnirs.html">rescale_mnirs</a></span><span class="op">(</span></span>
<span>        nirs_channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">nirs_channels</span><span class="op">)</span>, <span class="co">## grouped</span></span>
<span>        range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">data_rescaled</span>, label_time <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="mnirs-device-compatibility">mNIRS Device Compatibility<a class="anchor" aria-label="anchor" href="#mnirs-device-compatibility"></a>
</h2>
<p>This package is designed to recognise mNIRS data exported as <em>.csv</em> or <em>.xls(x)</em> files. It should be flexible for use with many different mNIRS devices, and compatibility will improve with continued development.</p>
<p>Currently, it has been tested successfully with mNIRS data exported from the following devices and apps:</p>
<ul>
<li>
<a href="https://www.artinis.com/oxysoft" class="external-link">Artinis</a> Oxysoft software (.csv and .xlsx)</li>
<li>
<a href="https://www.moxymonitor.com/" class="external-link">Moxy</a> direct export (.csv)</li>
<li>
<a href="https://perfprostudio.com/" class="external-link">PerfPro</a> PC software (.xlsx)</li>
<li>
<a href="https://train.red/" class="external-link">Train.Red</a> app (.csv)</li>
<li>
<a href="https://vo2master.com/features/" class="external-link">VO2 Master Manager</a> app (.xlsx)</li>
</ul>
</div>
<div class="section level2">
<h2 id="future-mnirs-development">Future <em>{mnirs}</em> Development<a class="anchor" aria-label="anchor" href="#future-mnirs-development"></a>
</h2>
<ul>
<li><p>Discrete interval processing</p></li>
<li>
<p>Process oxygenation kinetics</p>
<ul>
<li><p>Monoexponential &amp; sigmoidal curve fitting</p></li>
<li><p>non-parametric kinetics &amp; slope analysis</p></li>
</ul>
</li>
<li><p>Critical oxygenation breakpoint analysis</p></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/jemarnold/mnirs/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/jemarnold/mnirs/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mnirs</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jem Arnold <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0003-3908-9447" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://github.com/jemarnold/mnirs/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/jemarnold/mnirs/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/jemarnold/mnirs" class="external-link"><img src="https://codecov.io/gh/jemarnold/mnirs/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jem Arnold.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
