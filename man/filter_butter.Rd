% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_mnirs.R
\name{filter_butter}
\alias{filter_butter}
\title{Apply a Butterworth Digital Filter}
\usage{
filter_butter(
  x,
  n = 1,
  W,
  type = c("low", "high", "stop", "pass"),
  edges = c("rev", "rep1", "none"),
  na.rm = FALSE
)
}
\arguments{
\item{x}{A numeric vector.}

\item{n}{An integer defining the filter order for \verb{method = }
\emph{\code{"butterworth"}} (\emph{default} \code{n = 1}).}

\item{W}{A one- or two-element numeric vector defining the filter cutoff
frequency(ies) for \verb{method = }\emph{\code{"butterworth"}}, as a fraction of the
Nyquist frequency (see \emph{Details}).}

\item{type}{A character string indicating the digital filter type for
\verb{method = }\emph{\code{"butterworth"}} (see \emph{Details}).
\describe{
\item{\code{"low"}}{For a \emph{low-pass} filter (the \emph{default}).}
\item{\code{"high"}}{For a \emph{high-pass} filter.}
\item{\code{"stop"}}{For a \emph{stop-band} (band-reject) filter.}
\item{\code{"pass"}}{For a \emph{pass-band} filter.}
}}

\item{edges}{A character string indicating how to pad \code{x} for edge detection.
\describe{
\item{\code{"rev"}}{(\emph{the default}) Will pad \code{x} with the preceding 5\% data
in reverse sequence.}
\item{\code{"rep1"}}{Will pad \code{x} by repeating the last preceding value.}
\item{\code{"none"}}{Will return the unpadded \code{\link[signal:filtfilt]{signal::filtfilt()}} output.}
}}

\item{na.rm}{A logical indicating whether missing values should be ignored
(\code{TRUE}) before the filter is applied. Otherwise \code{FALSE} (the \emph{default})
will throw an error (see \emph{Details}).}
}
\value{
A numeric vector the same length as \code{x}.
}
\description{
Apply a Butterworth digital filter to vector data with \code{\link[signal:butter]{signal::butter()}}
and \code{\link[signal:filtfilt]{signal::filtfilt()}} which handles 'edges' better at the start and end
of the data.
}
\details{
Applies a centred (two-pass symmetrical) Butterworth digital filter from
\code{\link[signal:butter]{signal::butter()}} and \code{\link[signal:filtfilt]{signal::filtfilt()}}.

Filter \code{type} defines how the desired signal frequencies are either
passed or rejected from the output signal. \emph{Low-pass} and \emph{high-pass}
filters allow only frequencies \emph{lower} or \emph{higher} than the cutoff
frequency \code{W} to be passed through as the output signal, respectively.
\emph{Stop-band} defines a critical range of frequencies which are rejected
from the output signal. \emph{Pass-band} defines a critical range of
frequencies which are passed through as the output signal.

The filter order (number of passes) is defined by \code{n}, typically in
the range \verb{n = [1, 10]}. Higher filter order tends to capture more
rapid changes in amplitude, but also causes more distortion around
those change points in the signal. General advice is to use the
lowest filter order which sufficiently captures the desired rapid
responses in the data.

The critical (cutoff) frequency is defined by \code{W}, a numeric value for
\emph{low-pass} and \emph{high-pass} filters, or a two-element vector
\code{c(low, high)} defining the lower and upper bands for \emph{stop-band} and
\emph{pass-band} filters. \code{W} represents the desired fractional cutoff
frequency in the range \verb{W = [0, 1]}, where \code{1} is the Nyquist
frequency, i.e., half the sample rate of the data in Hz.

Missing values (\code{NA}) in \code{x} will cause an error unless \code{na.rm = TRUE}.
Then \code{NA}s will be preserved and passed through in the returned vector.
}
\examples{
set.seed(13)
sin <- sin(2 * pi * 1:150 / 50) * 20 + 40
noise <- rnorm(150, mean = 0, sd = 6)
noisy_sin <- sin + noise
filt_without_edge <- filter_butter(x = noisy_sin, n = 2, W = 0.1, edges = "none")
filt_with_edge <- filter_butter(x = noisy_sin, n = 2, W = 0.1, edges = "rep1")

\dontrun{
plot(noisy_sin, type = "l")
lines(filt_without_edge, col = "red", lwd = 4)
lines(filt_with_edge, col = "blue", lwd = 4)
}

}
\seealso{
\code{\link[signal:filtfilt]{signal::filtfilt()}} \code{\link[signal:butter]{signal::butter()}}
}
