% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/read_mnirs.R
\name{read_mnirs}
\alias{read_mnirs}
\title{Read \emph{{mnirs}} data from file}
\usage{
read_mnirs(
  file_path,
  nirs_channels,
  time_channel = NULL,
  event_channel = NULL,
  sample_rate = NULL,
  add_timestamp = FALSE,
  zero_time = FALSE,
  keep_all = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{file_path}{The file path including extension (either \emph{\code{".xlsx"}},
\emph{\code{".xls"}}, or \emph{\code{".csv"}}) to import.}

\item{nirs_channels}{A character vector indicating the mNIRS column names
to import from the file. Must match column names in the data file exactly.
A named character vector can be used to rename columns in the form:
\code{c(new_name = "original_name")} (see \emph{Details}).}

\item{time_channel}{An \emph{optional} character string indicating the time or
sample column name to import from the file. Must match column names in the
data file exactly. A named character vector can be used to rename columns
in the form: \code{c(new_name = "original_name")}. Time will be converted to
\emph{numeric} format (see \emph{Details}).}

\item{event_channel}{An \emph{optional} character string indicating the event or
lap column name to import from the file. Must match column names in the
data file exactly. A named character vector can be used to rename columns
in the form: \code{c(new_name = "original_name")} (see \emph{Details}).}

\item{sample_rate}{An \emph{optional} numeric value for the exported sample rate
in Hz. If not defined explicitly, will be estimated from the data (see
\emph{Details}).}

\item{add_timestamp}{\verb{<under development>} A logical to add a \emph{"timestamp"}
column with date-time values of class \emph{POSIXct}, if present in the
data file. Currently only functions if the existing \code{time_channel} data
are in timestamp format (see \emph{Details}).}

\item{zero_time}{A logical to re-calculate \code{time_channel} from zero or
preserve the original \code{time_channel} values (\code{FALSE}, the \emph{default}).}

\item{keep_all}{A logical to include all columns detected from the file
or only include the explicitly specified data columns (\code{FALSE}, the
\emph{default}).}

\item{verbose}{A logical to display (the \emph{default}) or silence (\code{FALSE})
warnings and information messages used for troubleshooting.}
}
\value{
A \link[tibble:tibble-package]{tibble} of class \emph{"mnirs"} with metadata
available with \code{attributes()}.
}
\description{
Read files exported from most commercially available mNIRS devices and
return a data frame of class \emph{"mnirs"} with recorded time series data
and metadata.
}
\details{
Channel names are matched to a single row, representing the header row for
data columns anywhere in the data file, not necessarily the top row of
the file.

Channels can be renamed in the format \code{c(new_name = "original_name")},
where \verb{*"original_name"*} should exactly match the column names found in
the file.

If there are duplicate column names in the file, the channel names will
attempt to match them in the order in which they appear. You may want to
confirm that the correct columns have been assigned to each channel as
intended.

\code{nirs_channels} must be defined explicitly and match column names exactly.
If \code{time_channel} is left blank, the function will attempt to identify a
time column automatically based on column names or values containing time
(\code{POSIXct}) data or time-formatted character strings (e.g. \emph{"hh:mm:ss"}).

\code{time_channel} will typically contain time values in seconds. However,
some NIRS devices (for example, \emph{Artinis} devices recorded with \emph{Oxysoft})
export the sample index (i.e. integer row numbers). If \emph{Oxysoft} export
sample rate is detected in the file metadata, a \code{"time"} column will be
added converting the sample indices to time values in seconds.

When the \code{time_channel} is provided in date-time (\emph{POSIXct}) format, it
will be converted to numeric values and re-calculated from zero,
even when \code{zero_time = FALSE}.

With \code{add_timestamp = TRUE}, an additional \emph{"timestamp "} column will be
added with the original date-time values. This functionality is currently
\verb{<under development>} to recognise start-time values in the file and
return absolute unix timestamps if available.

Setting \code{zero_time = TRUE} will re-calculate numeric \code{time_channel} values
to start from zero.

If \code{time_channel} contains irregular sampling (i.e., non-sequential,
repeated, or unordered values) a warning will be displayed (if
\code{verbose = TRUE}) suggesting that the user confirm the file data manually.

\code{sample_rate} is required for certain \code{{mnirs}} functions to work properly
and can be carried forward in the data frame metadata. If it is not
defined explicitly, it will be estimated from the differences between
values in the \code{time_channel}. As above, in certain cases where the
\code{time_channel} represents sample indices rather than time values,
\code{sample_rate} will be inaccurately estimated to be 1 Hz. In such cases,
\code{sample_rate} should be defined explicitly.

Columns and rows which contain entirely missing data (\code{NA}) are omitted.

\code{verbose = TRUE} will display warnings and information messages which can be
useful for troubleshooting. Errors causing abort messages will always be
displayed. Messages can be silenced globally with
\code{options(mnirs.verbose = FALSE)}.
}
\examples{
## call an example mNIRS data file
file_path <- example_mnirs("moxy_ramp")

read_mnirs(
    file_path,
    nirs_channels = c(                   ## identify and rename channels
        smo2_right = "SmO2 Live",
        smo2_left = "SmO2 Live(2)"
    ),
    time_channel = c(time = "hh:mm:ss"), ## date-time format will be converted to numeric
    sample_rate = NULL,                  ## sample_rate will be estimated from time_channel
    verbose = FALSE                      ## silence warnings & messages
)

}
