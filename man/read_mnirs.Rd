% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/read_mnirs.R
\name{read_mnirs}
\alias{read_mnirs}
\title{Read \emph{{mnirs}} data from file}
\usage{
read_mnirs(
  file_path,
  nirs_channels,
  time_channel = NULL,
  event_channel = NULL,
  sample_rate = NULL,
  add_timestamp = FALSE,
  zero_time = FALSE,
  keep_all = FALSE,
  inform = TRUE
)
}
\arguments{
\item{file_path}{The file path including extension (either \emph{\code{".xlsx"}},
\emph{\code{".xls"}}, or \emph{\code{".csv"}}) to import.}

\item{nirs_channels}{A character vector indicating the mNIRS column names
to import from the file. Must match column names in the data file exactly.
A named character vector can be used to rename columns in the form:
\code{c(new_name = "original_name")} (see \emph{Details}).}

\item{time_channel}{An \emph{optional} character string indicating the time or
sample column name to import from the file. Must match column names in the
data file exactly. A named character vector can be used to rename columns
in the form: \code{c(new_name = "original_name")}. Time will be converted to
\emph{numeric} format (see \emph{Details}).}

\item{event_channel}{An \emph{optional} character string indicating the event or
lap column name to import from the file. Must match column names in the
data file exactly. A named character vector can be used to rename columns
in the form: \code{c(new_name = "original_name")} (see \emph{Details}).}

\item{sample_rate}{An \emph{optional} numeric value for the exported sample rate
in Hz. If not defined explicitly, will be estimated from the data (see
\emph{Details}).}

\item{add_timestamp}{\verb{<under development>} A logical to add a \emph{"timestamp"}
column with date-time for each sample (class \emph{POSIXct}), if present in the
data file. If no absolute timestamp is detected, will instead return
relative time as \emph{hh:mm:ss}.}

\item{zero_time}{A logical to re-calculate \code{time_channel} to start
from zero or \code{FALSE} keep the original values (the \emph{default}).}

\item{keep_all}{A logical to include all columns detected from the file
or \code{FALSE} to only include the explicitly specified data columns
(the \emph{default}).}

\item{inform}{A logical to display (the \emph{default}) or \code{FALSE} to silence
warnings and information messages used for troubleshooting.}
}
\value{
A \link[tibble:tibble-package]{tibble} of class \emph{"mnirs"} with metadata
available with \code{attributes()}.
}
\description{
Read files exported from most commercially available mNIRS devices and
return a data frame of class \emph{"mnirs"} with recorded time series data
and metadata.
}
\details{
Channel names are matched to a single row, representing the header row for
data columns anywhere in the data file, not necessarily the top row of
the file.

Channels can be renamed in the format \code{c(new_name = "original_name")},
where \verb{*"original_name"*} should exactly match the column names found in
the file.

If there are duplicate column names in the file, the channel names will
attempt to match them in the order in which they appear. You may want to
confirm that the correct columns have been assigned to each channel as
intended.

\code{nirs_channels} must be defined explicitly and match column names exactly.
If \code{time_channel} is left blank, the function will attempt to identify a
time column automatically based on column names or values containing time
(\code{POSIXct}) data or time-formatted character strings (e.g. \emph{"hh:mm:ss"}).

\code{time_channel} will typically contain time values in seconds. However,
some NIRS devices (for example, \emph{Artinis} devices recorded with \emph{Oxysoft})
export the sample index (i.e. integer row numbers). If \emph{Oxysoft} export
sample rate is detected in the file metadata, a \code{"time"} column will be
added converting the sample indices to time values in seconds.

When the \code{time_channel} is provided in date-time format, it will be
converted to numeric values and re-calculated from zero. A timestamp
column can be included with absolute date-time (e.g.
\emph{"yyyy-mm-dd hh:mm:ss"}) if unix timestamps are present in the data file.
Otherwise, relative time (\emph{"hh:mm:ss"}) will be returned.

If \code{time_channel} contains irregular sampling (i.e., non-sequential,
repeated, or unordered values) a warning will be displayed (if
\code{inform = TRUE}) suggesting that the user confirm the file data manually.

\code{sample_rate} is required for certain \code{{mnirs}} functions to work properly
and can be carried forward in the data frame metadata. If it is not
defined explicitly, it will be estimated from the differences between
values in the \code{time_channel}. As above, in certain cases where the
\code{time_channel} represents sample indices rather than time values,
\code{sample_rate} will be inaccurately estimated to be 1 Hz. In such cases,
\code{sample_rate} should be defined explicitly.

Columns and rows which contain entirely missing data (\code{NA}) are omitted.

\code{inform = TRUE} will display warnings and information messages which can be
useful for troubleshooting. Errors causing abort messages will always be
displayed. Messages can be silenced globally with
\code{options(mnirs.inform = FALSE)}.
}
\examples{
## call an example mNIRS data file
file_path <- example_mnirs("moxy_ramp")

data_table <- read_mnirs(
    file_path,
    nirs_channels = c(smo2_right = "SmO2 Live", ## identify and rename channels
                      smo2_left = "SmO2 Live(2)"),
    time_channel = c(time = "hh:mm:ss"), ## date-time format will be converted to numeric
    inform = FALSE                       ## hide warnings & messages
)

data_table

}
